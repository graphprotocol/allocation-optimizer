<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Configuration · The Allocation Optimizer</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://graphprotocol.github.io/allocation-optimizer/configuration/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">The Allocation Optimizer</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Configuration</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../provided-binary/">Using The Provided Binary</a></li><li><a class="tocitem" href="../build-a-binary/">Build Your Own Binary</a></li><li><a class="tocitem" href="../call-julia/">Calling From Julia</a></li><li><a class="tocitem" href="../calling-another/">Calling From Another Language</a></li></ul></li><li><a class="tocitem" href="../output/">Understanding The Output</a></li><li><a class="tocitem" href="../api/">API Reference</a></li><li><a class="tocitem" href="../bugs/">Reporting Bugs</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Configuration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Configuration</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/graphprotocol/allocation-optimizer/blob/main/docs/src/configuration.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h1><p>When using the optimiser, you change it&#39;s behaviour via a configuration file specified as a TOML. The configuration file serves two purposes. Firstly, it makes it easier for you to track various settings and their impacts. Secondly, if something breaks, it makes it easier for us to reproduce what went wrong.</p><p>An example configuration TOML file might look as below.</p><pre><code class="language-toml hljs">id = &quot;0xd75c4dbcb215a6cf9097cfbcc70aab2596b96a9c&quot;
writedir = &quot;data&quot;
readdir = &quot;data&quot;
max_allocations = 10
whitelist = []
blacklist = []
frozenlist = []
pinnedlist = []
allocation_lifetime = 28
gas = 100
min_signal = 100
verbose = true
num_reported_options = 2
execution_mode = &quot;none&quot;
opt_mode = &quot;fast&quot;
protocol_network = &quot;mainnet&quot;
syncing_networks = [&quot;mainnet&quot;]</code></pre><h3 id="Detailed-Field-Descriptions"><a class="docs-heading-anchor" href="#Detailed-Field-Descriptions">Detailed Field Descriptions</a><a id="Detailed-Field-Descriptions-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-Field-Descriptions" title="Permalink"></a></h3><ul><li><code>id::String</code>: The ID of the indexer for whom we&#39;re optimising. No default value.</li><li><code>network_subgraph_endpoint::String</code>: The network subgraph endpoint to query. The optimizer    support any network (such as mainnet, goerli, arbitrum-one, arbitrum-goerli) as long as the    provided API serves the query requests. If unspecified,    <code>&quot;https://api.thegraph.com/subgraphs/name/graphprotocol/graph-network-mainnet&quot;</code></li><li><code>writedir::String</code>: The directory to which to write the results of optimisation.   If don&#39;t specify <code>readdir</code>, <code>writedir</code> also specifies the path to which to save   the input data tables. If unspecified, <code>&quot;.&quot;</code></li><li><code>readdir::Union{String, Nothing}</code>: The directory from which to read saved data tables.   This speeds up the process as we won&#39;t have to query the network subgraph for the   relevant data. If you don&#39;t specify <code>readdir</code>, we will query your specified   <code>network_subgraph_endpoint</code> for the data and write it to CSV files in <code>writedir</code>.   This way, you can use your previous <code>writedir</code> as your <code>readdir</code> in future runs.   If unspecified, <code>nothing</code></li><li><code>whitelist::Vector{String}</code>: A list of subgraph IPFS hashes that you want to consider   as candidates to which to allocate. If you leave this empty, we&#39;ll assume all subgraphs   are in the whitelist. If unspecified, <code>String[]</code></li><li><code>blacklist::Vector{String}</code>: A list of subgraph IPFS hashes that you do not want to   consider allocating to. For example, this list could include broken subgraphs or   subgraphs that you don&#39;t want to index. If unspecified, <code>String[]</code></li><li><code>frozenlist::Vector{String}</code>: If you have open allocations that you don&#39;t want to change,   add the corresponding subgraph IPFS hashes to this list. If unspecified, <code>String[]</code></li><li><code>pinnedlist::Vector{String}</code>: If you have subgraphs that you absolutely want to be   allocated to, even if only with a negligible amount of GRT, add it to this list.   If unspecified, <code>String[]</code></li><li><code>allocation_lifetime::Integer</code>: The number of epochs for which you expect the allocations   the optimiser finds to be open. If unspecified, <code>28</code></li><li><code>gas::Real</code>: The estimated gas cost in GRT to open/close allocations. If unspecified, <code>100</code></li><li><code>min_signal::Real</code>: The minimum amount of signal in GRT that must be on a subgraph   in order for you to consider allocating to it. If unspecified, <code>100</code></li><li><code>max_allocations::Integer</code>: The maximum number of new allocations you&#39;d like the optimiser   to consider opening. If unspecified, <code>10</code></li><li><code>num_reported_options::Integer</code>: The number of proposed allocation strategies to report.   For example, if you select <code>10</code> we&#39;d report best 10 allocation strategies ranked by   profit. Options are reported to a <em>report.json</em> in your <code>writedir</code>. If unspecified, <code>1</code></li><li><code>verbose::Bool</code>: If true, the optimiser will print details about what it is doing to   stdout. If unspecified, <code>false</code></li><li><code>execution_mode::String</code>: How the optimiser should execute the allocation strategies it   finds. Options are <code>&quot;none&quot;</code>, which won&#39;t do anything, <code>&quot;actionqueue&quot;</code>, which will   push actions to the action queue, and <code>&quot;rules&quot;</code>, which will generate indexing rules.   If unspecified, <code>&quot;none&quot;</code></li><li><code>indexer_url::Union{String, Nothing}</code>: The URL of the indexer management server you want   to execute the allocation strategies on. If you specify <code>&quot;actionqueue&quot;</code>, you must also   specify <code>indexer_url</code>. If unspecified, <code>nothing</code></li><li><code>opt_mode::String</code>: We support two optimisation modes. One is <code>&quot;fast&quot;</code>. This mode is   fast, but may not find the optimal strategy. This mode is also used to the top   <code>num_reported_options</code> allocation strategies. The other mode is <code>&quot;optimal&quot;</code>. This   mode is slower, but it satisfy stronger optimality conditions. It will find strategies   at least as good as <code>&quot;fast&quot;</code>, but not guaranteed to be better. In general, we recommend   exploring config options using <code>&quot;fast&quot;</code> mode first, and then using <code>&quot;optimal&quot;</code>   mode to find the optimal allocation. By default, <code>&quot;optimal&quot;</code></li><li><code>protocol_network::String</code>: Defines the protocol network that allocation transactions    should be sent to. The current protocol network options are &quot;mainnet&quot;, &quot;goerli&quot;,    &quot;arbitrum&quot;, and &quot;arbitrum-goerli&quot;. By default, <code>&quot;mainnet&quot;</code></li><li><code>syncing_networks::Vector{String}</code>: The list of syncing networks to support when selecting    the set of possible subgraphs. This list should match the networks available to your    graph-node. By default, the list is a singleton of your protocol network</li></ul><h3 id="Example-Configurations"><a class="docs-heading-anchor" href="#Example-Configurations">Example Configurations</a><a id="Example-Configurations-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Configurations" title="Permalink"></a></h3><h4 id="ActionQueue"><a class="docs-heading-anchor" href="#ActionQueue">ActionQueue</a><a id="ActionQueue-1"></a><a class="docs-heading-anchor-permalink" href="#ActionQueue" title="Permalink"></a></h4><p>Set <code>execution_mode</code> to <code>&quot;actionqueue&quot;</code> and provide an <code>indexer_url</code>.</p><pre><code class="language-toml hljs">id = &quot;0xd75c4dbcb215a6cf9097cfbcc70aab2596b96a9c&quot;
writedir = &quot;data&quot;
readdir = &quot;data&quot;
max_allocations = 10
whitelist = []
blacklist = []
frozenlist = []
pinnedlist = []
allocation_lifetime = 28
gas = 100
min_signal = 100
verbose = true
num_reported_options = 2
execution_mode = &quot;actionqueue&quot;
indexer_url = &quot;https://localhost:8000&quot;
protocol_network = &quot;arbitrum&quot;
syncing_network = [&quot;mainnet&quot;]</code></pre><h4 id="Indexer-Rules"><a class="docs-heading-anchor" href="#Indexer-Rules">Indexer Rules</a><a id="Indexer-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Indexer-Rules" title="Permalink"></a></h4><p>Change <code>execution_mode</code> to <code>&quot;rules&quot;</code>.</p><pre><code class="language-toml hljs">id = &quot;0xd75c4dbcb215a6cf9097cfbcc70aab2596b96a9c&quot;
writedir = &quot;data&quot;
readdir = &quot;data&quot;
max_allocations = 10
whitelist = []
blacklist = []
frozenlist = []
pinnedlist = []
allocation_lifetime = 28
gas = 100
min_signal = 100
verbose = true
num_reported_options = 2
execution_mode = &quot;rules&quot;</code></pre><h4 id="Query-data-Instead-of-Reading-Local-CSVs"><a class="docs-heading-anchor" href="#Query-data-Instead-of-Reading-Local-CSVs">Query data Instead of Reading Local CSVs</a><a id="Query-data-Instead-of-Reading-Local-CSVs-1"></a><a class="docs-heading-anchor-permalink" href="#Query-data-Instead-of-Reading-Local-CSVs" title="Permalink"></a></h4><p>Just don&#39;t specify the <code>readdir</code>.</p><pre><code class="language-toml hljs">id = &quot;0xd75c4dbcb215a6cf9097cfbcc70aab2596b96a9c&quot;
writedir = &quot;data&quot;
max_allocations = 10
whitelist = []
blacklist = []
frozenlist = []
pinnedlist = []
allocation_lifetime = 28
gas = 100
min_signal = 100
verbose = true
num_reported_options = 2
execution_mode = &quot;none&quot;</code></pre><h4 id="Query-data-for-specified-networks"><a class="docs-heading-anchor" href="#Query-data-for-specified-networks">Query data for specified networks</a><a id="Query-data-for-specified-networks-1"></a><a class="docs-heading-anchor-permalink" href="#Query-data-for-specified-networks" title="Permalink"></a></h4><p>Specify the network subgraph endpoint for networks other than The Graph network on Ethereum mainnet. Here we use the endpoint to goerli network subgraph.</p><pre><code class="language-toml hljs">id = &quot;0xE9a1CABd57700B17945Fd81feeFba82340D9568F&quot;
network_subgraph_endpoint = &quot;https://api.thegraph.com/subgraphs/name/graphprotocol/graph-network-goerli&quot;</code></pre><p>Other available endpoints examples are</p><ul><li>Mainnet (default): https://api.thegraph.com/subgraphs/name/graphprotocol/graph-network-mainnet</li><li>Arbitrum-One: https://api.thegraph.com/subgraphs/name/graphprotocol/graph-network-arbitrum</li><li>Arbitrum-Goerli: https://api.thegraph.com/subgraphs/name/graphprotocol/graph-network-arbitrum-goerli</li></ul><h4 id="Quiet-Mode"><a class="docs-heading-anchor" href="#Quiet-Mode">Quiet Mode</a><a id="Quiet-Mode-1"></a><a class="docs-heading-anchor-permalink" href="#Quiet-Mode" title="Permalink"></a></h4><p>We set <code>verbose</code> to <code>false</code> here to surpress info messages.</p><pre><code class="language-toml hljs">id = &quot;0xd75c4dbcb215a6cf9097cfbcc70aab2596b96a9c&quot;
writedir = &quot;data&quot;
readdir = &quot;data&quot;
max_allocations = 10
whitelist = []
blacklist = []
frozenlist = []
pinnedlist = []
allocation_lifetime = 28
gas = 100
min_signal = 100
verbose = false
num_reported_options = 2
execution_mode = &quot;none&quot;</code></pre><h4 id="Whitelisting-Subgraphs"><a class="docs-heading-anchor" href="#Whitelisting-Subgraphs">Whitelisting Subgraphs</a><a id="Whitelisting-Subgraphs-1"></a><a class="docs-heading-anchor-permalink" href="#Whitelisting-Subgraphs" title="Permalink"></a></h4><p>Add some subgraph deployment IDs to the <code>whitelist</code>. If, in addition or instead you want to use <code>blacklist</code>, <code>frozenlist</code>, or <code>pinnedlist</code>, you can similarly add subgraph deployment IDs to those lists. Notice that we did not change <code>max_allocations</code> here. If <code>max_allocations</code> exceeds the number of available subgraphs (2 in this case), the code will treat the number of available subgraphs as <code>max_allocations</code>.</p><pre><code class="language-toml hljs">id = &quot;0xd75c4dbcb215a6cf9097cfbcc70aab2596b96a9c&quot;
writedir = &quot;data&quot;
readdir = &quot;data&quot;
max_allocations = 10
whitelist = [
    &quot;QmUVskWrz1ZiQZ76AtyhcfFDEH1ELnRpoyEhVL8p6NFTbR&quot;,
    &quot;QmcBSr5R3K2M5tk8qeHFaX8pxAhdViYhcKD8ZegYuTcUhC&quot;
]
blacklist = []
frozenlist = []
pinnedlist = []
allocation_lifetime = 28
gas = 100
min_signal = 100
verbose = false
num_reported_options = 2
execution_mode = &quot;none&quot;</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../provided-binary/">Using The Provided Binary »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 25 January 2024 14:51">Thursday 25 January 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
